[
  {
    "id": "nll-schema-001",
    "category": "schema",
    "description": "Create nll.schema.ts file with NLLSeasonId branded type",
    "passes": true,
    "steps": [
      "Create src/nll/nll.schema.ts",
      "Define NLLSeasonId: Schema.Number.pipe(Schema.int(), Schema.positive(), Schema.brand('NLLSeasonId'))",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-002",
    "category": "schema",
    "description": "NLLTeam response schema",
    "passes": true,
    "steps": [
      "Define NLLTeam Schema.Class with fields: id, code, name, nickname, displayName, team_city, team_logo, team_website_url",
      "All string fields nullable except id and code",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-003",
    "category": "schema",
    "description": "NLLPlayerSeasonStats nested schema",
    "passes": true,
    "steps": [
      "Define NLLPlayerSeasonStats Schema.Class",
      "Fields: goals, assists, points, penalty_minutes, games_played (all Schema.Number)",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-004",
    "category": "schema",
    "description": "NLLPlayer response schema",
    "passes": true,
    "steps": [
      "Define NLLPlayer Schema.Class",
      "Fields: personId (string), firstname, surname, fullname, dateOfBirth, height, weight, position, jerseyNumber",
      "Add team_id, team_code, team_name fields",
      "Add matches field with Schema.optional for nested stats",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-005",
    "category": "schema",
    "description": "NLLStanding response schema",
    "passes": true,
    "steps": [
      "Define NLLStanding Schema.Class",
      "Fields: team_id, name, wins, losses, games_played, win_percentage, goals_for, goals_against, goal_diff, position",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-006",
    "category": "schema",
    "description": "NLLVenue nested schema",
    "passes": true,
    "steps": [
      "Define NLLVenue Schema.Class",
      "Fields: id, name, city (all nullable strings except id)",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-007",
    "category": "schema",
    "description": "NLLSquad nested schema",
    "passes": true,
    "steps": [
      "Define NLLSquad Schema.Class",
      "Fields: id (string), name, code, score (number), isHome (boolean)",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-008",
    "category": "schema",
    "description": "NLLMatch response schema",
    "passes": true,
    "steps": [
      "Define NLLMatch Schema.Class",
      "Fields: id, date, status, venue (NLLVenue), winningSquadId",
      "Add squads object with away/home NLLSquad fields",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-009",
    "category": "schema",
    "description": "NLL request schemas",
    "passes": true,
    "steps": [
      "Define NLLTeamsRequest Schema.Class { seasonId: NLLSeasonId }",
      "Define NLLPlayersRequest Schema.Class { seasonId: NLLSeasonId }",
      "Define NLLStandingsRequest Schema.Class { seasonId: NLLSeasonId }",
      "Define NLLScheduleRequest Schema.Class { seasonId: NLLSeasonId }",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-010",
    "category": "schema",
    "description": "TeamsMapToArray transform schema",
    "passes": true,
    "steps": [
      "Create NLLTeamRaw schema for API response structure",
      "Create TeamsMapToArray Schema.transform",
      "Transform Record<id, TeamData> -> NLLTeam[]",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-011",
    "category": "schema",
    "description": "PlayersMapToArray transform schema",
    "passes": true,
    "steps": [
      "Create NLLPlayerRaw schema for API response structure",
      "Create PlayersMapToArray Schema.transform",
      "Transform Record<personId, PlayerData> -> NLLPlayer[]",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-012",
    "category": "schema",
    "description": "NLL response wrapper schemas",
    "passes": true,
    "steps": [
      "Define NLLTeamsResponse using TeamsMapToArray",
      "Define NLLPlayersResponse using PlayersMapToArray",
      "Define NLLStandingsResponse as Schema.Array(NLLStanding)",
      "Define NLLScheduleResponse with week-based structure",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-schema-013",
    "category": "schema",
    "description": "Export all schemas from nll.schema.ts",
    "passes": true,
    "steps": [
      "Add export statements for all schemas",
      "Add export for branded NLLSeasonId type",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-config-001",
    "category": "config",
    "description": "Add NLLConfig service to config.ts",
    "passes": true,
    "steps": [
      "Open src/config.ts",
      "Add NLLConfig Effect.Service class",
      "Set baseUrl: https://nllstatsapp.aordev.com/",
      "Set headers: origin=https://www.nll.com, referer=https://www.nll.com/",
      "No auth tokens needed (public API)",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-client-001",
    "category": "client",
    "description": "Create nll.client.ts with base structure",
    "passes": true,
    "steps": [
      "Create src/nll/nll.client.ts",
      "Import Effect, Schema, ParseResult",
      "Import makeRestClient from api-client",
      "Import NLLConfig from config",
      "Import ParseError from error",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-client-002",
    "category": "client",
    "description": "Define mapParseError helper",
    "passes": true,
    "steps": [
      "Add mapParseError function following PLL pattern",
      "Maps ParseResult.ParseError to ParseError",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-client-003",
    "category": "client",
    "description": "Create NLLClient service shell",
    "passes": true,
    "steps": [
      "Define NLLClient as Effect.Service",
      "Yield NLLConfig in effect",
      "Create restClient via makeRestClient with config",
      "Set dependencies: [NLLConfig.Default]",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-client-004",
    "category": "client",
    "description": "Implement NLLClient.getTeams method",
    "passes": true,
    "steps": [
      "Add getTeams(input: NLLTeamsRequest.Encoded)",
      "Decode input via Schema.decode with mapParseError",
      "Build endpoint: ?data_type=teams&season_id={seasonId}",
      "Call restClient.get with NLLTeamsResponse",
      "Add Effect.tap logging: 'Fetched {n} teams for season {id}'",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-client-005",
    "category": "client",
    "description": "Implement NLLClient.getPlayers method",
    "passes": true,
    "steps": [
      "Add getPlayers(input: NLLPlayersRequest.Encoded)",
      "Decode input via Schema.decode with mapParseError",
      "Build endpoint: ?data_type=players&season_id={seasonId}",
      "Call restClient.get with NLLPlayersResponse",
      "Add Effect.tap logging",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-client-006",
    "category": "client",
    "description": "Implement NLLClient.getStandings method",
    "passes": false,
    "steps": [
      "Add getStandings(input: NLLStandingsRequest.Encoded)",
      "Decode input via Schema.decode with mapParseError",
      "Build endpoint: ?data_type=standings&season_id={seasonId}",
      "Call restClient.get with NLLStandingsResponse",
      "Add Effect.tap logging",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-client-007",
    "category": "client",
    "description": "Implement NLLClient.getSchedule method",
    "passes": false,
    "steps": [
      "Add getSchedule(input: NLLScheduleRequest.Encoded)",
      "Decode input via Schema.decode with mapParseError",
      "Build endpoint: ?data_type=schedule&season_id={seasonId}",
      "Call restClient.get with NLLScheduleResponse",
      "Flatten weekly schedule to match array if needed",
      "Add Effect.tap logging",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-client-008",
    "category": "client",
    "description": "Create NLL module index exports",
    "passes": false,
    "steps": [
      "Create src/nll/index.ts",
      "Export NLLClient from nll.client.ts",
      "Export all schema types from nll.schema.ts",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-test-001",
    "category": "test",
    "description": "Create NLL integration test file",
    "passes": false,
    "steps": [
      "Create src/nll/nll.integration.test.ts",
      "Import Effect, describe, expect, it from vitest",
      "Import NLLClient",
      "Setup describe block for NLLClient",
      "Run: bun test src/nll/ --dry-run"
    ]
  },
  {
    "id": "nll-test-002",
    "category": "test",
    "description": "getTeams integration test",
    "passes": false,
    "steps": [
      "Add describe block for getTeams",
      "Add test: 'fetches teams for season 225'",
      "Call client.getTeams({ seasonId: 225 })",
      "Assert result.length > 0",
      "Assert team has id, code, name fields",
      "Run: bun test src/nll/ -t 'getTeams'"
    ]
  },
  {
    "id": "nll-test-003",
    "category": "test",
    "description": "getPlayers integration test",
    "passes": false,
    "steps": [
      "Add describe block for getPlayers",
      "Add test: 'fetches players for season 225'",
      "Call client.getPlayers({ seasonId: 225 })",
      "Assert result.length > 0",
      "Assert player has personId, firstname, team_id",
      "Run: bun test src/nll/ -t 'getPlayers'"
    ]
  },
  {
    "id": "nll-test-004",
    "category": "test",
    "description": "getStandings integration test",
    "passes": false,
    "steps": [
      "Add describe block for getStandings",
      "Add test: 'fetches standings for season 225'",
      "Call client.getStandings({ seasonId: 225 })",
      "Assert result.length > 0",
      "Assert standing has team_id, wins, losses",
      "Run: bun test src/nll/ -t 'getStandings'"
    ]
  },
  {
    "id": "nll-test-005",
    "category": "test",
    "description": "getSchedule integration test",
    "passes": false,
    "steps": [
      "Add describe block for getSchedule",
      "Add test: 'fetches schedule for season 225'",
      "Call client.getSchedule({ seasonId: 225 })",
      "Assert result.length > 0",
      "Assert match has id, squads, date, status",
      "Run: bun test src/nll/ -t 'getSchedule'"
    ]
  },
  {
    "id": "nll-test-006",
    "category": "test",
    "description": "All NLL client tests pass",
    "passes": false,
    "steps": [
      "Run: bun test src/nll/",
      "All 4 endpoint tests pass",
      "No schema validation errors"
    ]
  },
  {
    "id": "nll-manifest-001",
    "category": "extract",
    "description": "Create NLLSeasonManifest schema",
    "passes": false,
    "steps": [
      "Create src/extract/nll/nll.manifest.ts",
      "Define NLLEntityStatus schema (same as PLL)",
      "Define NLLSeasonManifest with teams, players, standings, schedule fields",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-manifest-002",
    "category": "extract",
    "description": "Create NLLExtractionManifest schema",
    "passes": false,
    "steps": [
      "Define NLLExtractionManifest schema",
      "Fields: source='nll', seasons Record, lastRun, version",
      "Add createEmptyNLLManifest helper",
      "Add createEmptyNLLSeasonManifest helper",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-manifest-003",
    "category": "extract",
    "description": "Create NLLManifestService",
    "passes": false,
    "steps": [
      "Define NLLManifestService as Effect.Service",
      "Inject ExtractConfigService, FileSystem, Path",
      "Set manifestPath: output/nll/manifest.json",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-manifest-004",
    "category": "extract",
    "description": "Implement NLLManifestService.load method",
    "passes": false,
    "steps": [
      "Add load method",
      "Check if manifest file exists",
      "If not exists, return createEmptyNLLManifest",
      "Read and parse JSON file",
      "Decode with schema, fallback to empty on error",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-manifest-005",
    "category": "extract",
    "description": "Implement NLLManifestService.save method",
    "passes": false,
    "steps": [
      "Add save(manifest) method",
      "Create directory if not exists",
      "Write manifest to JSON file",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-manifest-006",
    "category": "extract",
    "description": "Implement NLLManifestService helper methods",
    "passes": false,
    "steps": [
      "Add getSeasonManifest(manifest, seasonId) method",
      "Add markComplete(manifest, seasonId, entity, count, durationMs) method",
      "Add isExtracted(manifest, seasonId, entity) method",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-001",
    "category": "extract",
    "description": "Create NLLExtractorService base structure",
    "passes": false,
    "steps": [
      "Create src/extract/nll/nll.extractor.ts",
      "Define NLLExtractorService as Effect.Service",
      "Inject NLLClient, ExtractConfigService, NLLManifestService, FileSystem, Path",
      "Define NLL_SEASONS array [225]",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-002",
    "category": "extract",
    "description": "Implement extractor helper functions",
    "passes": false,
    "steps": [
      "Add getOutputPath(seasonId, entity) helper",
      "Add saveJson<T>(filePath, data) helper",
      "Add withTiming<T>(effect) wrapper for timing extraction",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-003",
    "category": "extract",
    "description": "Implement extractTeams method",
    "passes": false,
    "steps": [
      "Add extractTeams(seasonId) method",
      "Log: 'ðŸ“Š Extracting teams...'",
      "Call client.getTeams with timing",
      "Save to output/nll/{seasonId}/teams.json",
      "Log: 'âœ“ {n} teams ({ms}ms)'",
      "Handle errors gracefully returning empty result",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-004",
    "category": "extract",
    "description": "Implement extractPlayers method",
    "passes": false,
    "steps": [
      "Add extractPlayers(seasonId) method",
      "Log: 'ðŸ‘¥ Extracting players...'",
      "Call client.getPlayers with timing",
      "Save to output/nll/{seasonId}/players.json",
      "Log: 'âœ“ {n} players ({ms}ms)'",
      "Handle errors gracefully",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-005",
    "category": "extract",
    "description": "Implement extractStandings method",
    "passes": false,
    "steps": [
      "Add extractStandings(seasonId) method",
      "Log: 'ðŸ“ˆ Extracting standings...'",
      "Call client.getStandings with timing",
      "Save to output/nll/{seasonId}/standings.json",
      "Log: 'âœ“ {n} standings ({ms}ms)'",
      "Handle errors gracefully",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-006",
    "category": "extract",
    "description": "Implement extractSchedule method",
    "passes": false,
    "steps": [
      "Add extractSchedule(seasonId) method",
      "Log: 'ðŸŽ® Extracting schedule...'",
      "Call client.getSchedule with timing",
      "Save to output/nll/{seasonId}/schedule.json",
      "Log: 'âœ“ {n} matches ({ms}ms)'",
      "Handle errors gracefully",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-007",
    "category": "extract",
    "description": "Implement extractSeason orchestrator",
    "passes": false,
    "steps": [
      "Add extractSeason(seasonId, options) method",
      "Options: { skipExisting: boolean }",
      "Load manifest at start",
      "Check manifest to skip existing if skipExisting=true",
      "Call extractTeams, update manifest, save",
      "Call extractPlayers, update manifest, save",
      "Call extractStandings, update manifest, save",
      "Call extractSchedule, update manifest, save",
      "Add 500ms delay between requests (rate limiting)",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-008",
    "category": "extract",
    "description": "Create NLL extraction module exports",
    "passes": false,
    "steps": [
      "Create src/extract/nll/index.ts",
      "Export NLLExtractorService",
      "Export NLLManifestService",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-009",
    "category": "extract",
    "description": "Create NLL extraction CLI entry point",
    "passes": false,
    "steps": [
      "Create src/extract/nll/run.ts",
      "Parse CLI args for seasonId (default 225)",
      "Build Layer with NLLExtractorService.Default + BunContext.layer",
      "Call extractor.extractSeason",
      "Use BunRuntime.runMain",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-extract-010",
    "category": "extract",
    "description": "Test NLL extraction runs successfully",
    "passes": false,
    "steps": [
      "Run: bun src/extract/nll/run.ts",
      "Verify output/nll/225/teams.json created",
      "Verify output/nll/225/players.json created",
      "Verify output/nll/225/standings.json created",
      "Verify output/nll/225/schedule.json created",
      "Verify output/nll/manifest.json created"
    ]
  },
  {
    "id": "nll-validate-001",
    "category": "validate",
    "description": "Create validate-nll.ts file structure",
    "passes": false,
    "steps": [
      "Create src/validate/validate-nll.ts",
      "Import FileSystem, Path from @effect/platform",
      "Import BunContext, BunRuntime from @effect/platform-bun",
      "Import Effect, Layer from effect",
      "Import ExtractConfigService",
      "Import validation helpers from validate.service",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-validate-002",
    "category": "validate",
    "description": "Define NLL validation interfaces",
    "passes": false,
    "steps": [
      "Define NLLTeam interface for validation",
      "Define NLLPlayer interface for validation",
      "Define NLLStanding interface for validation",
      "Define NLLMatch interface for validation",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-validate-003",
    "category": "validate",
    "description": "Implement teams.json validation",
    "passes": false,
    "steps": [
      "Add validation for teams.json",
      "Validate required fields: id, code, name",
      "Validate unique id field",
      "Add results to fileResults array",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-validate-004",
    "category": "validate",
    "description": "Implement players.json validation",
    "passes": false,
    "steps": [
      "Add validation for players.json",
      "Validate required fields: personId, firstname, team_id",
      "Validate unique personId field",
      "Add results to fileResults array",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-validate-005",
    "category": "validate",
    "description": "Implement standings.json validation",
    "passes": false,
    "steps": [
      "Add validation for standings.json",
      "Validate required fields: team_id, wins, losses",
      "Validate unique team_id field",
      "Add results to fileResults array",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-validate-006",
    "category": "validate",
    "description": "Implement schedule.json validation",
    "passes": false,
    "steps": [
      "Add validation for schedule.json",
      "Validate required fields: id, date, status",
      "Validate unique id field",
      "Add results to fileResults array",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-validate-007",
    "category": "validate",
    "description": "Implement cross-reference validations",
    "passes": false,
    "steps": [
      "Add crossReference: players.team_id -> teams.id",
      "Add crossReference: standings.team_id -> teams.id",
      "Add results to crossRefs array",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-validate-008",
    "category": "validate",
    "description": "Complete validation script with report",
    "passes": false,
    "steps": [
      "Build validation report using buildReport",
      "Print report using printReport",
      "Save report to output/nll/validation-report.json",
      "Add BunRuntime.runMain",
      "Run typecheck"
    ]
  },
  {
    "id": "nll-validate-009",
    "category": "validate",
    "description": "Test NLL validation runs successfully",
    "passes": false,
    "steps": [
      "Run: bun src/validate/validate-nll.ts",
      "Verify validation report shows no errors",
      "Verify output/nll/validation-report.json created"
    ]
  },
  {
    "id": "nll-docs-001",
    "category": "docs",
    "description": "Add NLLClient Methods table to CLAUDE.md",
    "passes": false,
    "steps": [
      "Open packages/pipeline/CLAUDE.md",
      "Add NLLClient Methods table after PLLClient Methods",
      "Include getTeams, getPlayers, getStandings, getSchedule methods"
    ]
  },
  {
    "id": "nll-docs-002",
    "category": "docs",
    "description": "Add NLL commands to CLAUDE.md",
    "passes": false,
    "steps": [
      "Add NLL extraction command: bun src/extract/nll/run.ts",
      "Add NLL validation command: bun src/validate/validate-nll.ts",
      "Add note about NLL API being public (no credentials needed)"
    ]
  },
  {
    "id": "nll-final-001",
    "category": "final",
    "description": "Run full typecheck",
    "passes": false,
    "steps": [
      "Run: bun run typecheck",
      "Fix any type errors",
      "All files compile successfully"
    ]
  },
  {
    "id": "nll-final-002",
    "category": "final",
    "description": "Run all NLL tests",
    "passes": false,
    "steps": [
      "Run: bun test src/nll/",
      "All integration tests pass",
      "No schema validation errors"
    ]
  },
  {
    "id": "nll-final-003",
    "category": "final",
    "description": "Run full extraction",
    "passes": false,
    "steps": [
      "Run: bun src/extract/nll/run.ts",
      "All 4 data files created",
      "Manifest updated correctly"
    ]
  },
  {
    "id": "nll-final-004",
    "category": "final",
    "description": "Run full validation",
    "passes": false,
    "steps": [
      "Run: bun src/validate/validate-nll.ts",
      "Validation report shows all checks pass",
      "Cross-references validate correctly"
    ]
  },
  {
    "id": "nll-final-005",
    "category": "final",
    "description": "Verify all output files",
    "passes": false,
    "steps": [
      "Verify: ls -la output/nll/225/",
      "teams.json exists and has content",
      "players.json exists and has content",
      "standings.json exists and has content",
      "schedule.json exists and has content",
      "manifest.json exists and is valid"
    ]
  }
]
